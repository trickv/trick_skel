#!/bin/sh

export PATH=$PATH:/usr/local/bin

cd $HOME/src/trick_skel
if [ $? -ne 0 ]; then
    echo "can't cd to trick_skel, bailing out"
    exit
fi

TRICK_HOSTNAME=`hostname -s`

if [ "${TRICK_HOSTNAME}" = "atlas" ]; then
    source ~/.proxy_auth
fi

case $TRICK_HOSTNAME in
    sting|mc|sam|atlas|vanstaveren|ed)
        svn up > /dev/null
        SVN_STAT=`svn stat`
        if [ "$SVN_STAT" != "" ]; then
            echo "Local modifications exist:"
            echo $SVN_STAT
            echo
        fi
        break;;
    cartman|bigweld|doobie|willow|gasket|diesel|baldrick|darth|raquel)
        ./update-mintel-rsync.sh
        break;;
    *)
        echo "no update location set in cron-daily, help me."
        break;;
esac

./install.sh > /dev/null
