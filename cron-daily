#!/usr/bin/env bash

export PATH=$PATH:/usr/local/bin

cd $HOME/src/trick_skel
if [ $? -ne 0 ]; then
    echo "can't cd to trick_skel, bailing out"
    exit
fi

TRICK_HOSTNAME=`hostname -s`

if [ "${TRICK_HOSTNAME}" = "atlas" ]; then
    source $HOME/.proxy_auth
fi

case $TRICK_HOSTNAME in
    sting|mc|sam|atlas|vanstaveren|ed|ss)
        . $HOME/.keychain/`hostname`-sh
        svn up > /dev/null
        SVN_STAT=`svn stat`
        if [ "$SVN_STAT" != "" ]; then
            echo "Local modifications exist:"
            echo $SVN_STAT
            echo
        fi
        ;;
    survey-app01|gasket|raquel)
        ./update-mintel-rsync.sh
        ;;
    *)
        echo "no update location set in cron-daily for hostname=${TRICK_HOSTNAME}, help me."
        ;;
esac

./install > /dev/null
