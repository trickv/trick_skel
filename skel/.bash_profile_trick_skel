#!/bin/sh

# trickv's bash_profile skeleton
# Should run on any sh-compatible shell, but realistically probably only bash.

export PATH=~/bin:$PATH
export PKG_CONFIG_PATH=/usr/local/lib/pkgconfig:$PKG_CONFIG_PATH

# Handy environment variables that make me happy
export PAGER=less
export EDITOR=vim
export MONO_THEME=clearlooks
# TODO: this is not true on all boxen
export MOZILLA_FIVE_HOME=/usr/lib/seamonkey/

# My fancy BASH prompt
# TODO: alternate the color of the username when this is root
# TODO: don't colorize if color isn't available in this terminal.  see system bashrc on any gentoo box
TRICKV_HOSTNAME=`hostname -s`
case $TRICKV_HOSTNAME in
    sting) TRICKV_HOSTNAME_COLOR="1;32m";;
    willow) TRICKV_HOSTNAME_COLOR="1;33m";;
    anya) TRICKV_HOSTNAME_COLOR="1;33m";;
    *) TRICKV_HOSTNAME_COLOR="1;32m";;
esac
TRICKV_USERNAME_COLOR="01;37m";
export PS1="\[\033[${TRICKV_USERNAME_COLOR}\]\u\[\033[1;33m\]@\[\033[${TRICKV_HOSTNAME_COLOR}\]\h\[\033[1;33m\]:\[\033[01;34m\]\w\[\033[1;31m\]/\[\033[00m\] "
export PS2='>'
unset TRICKV_HOSTNAME_COLOR TRICKV_USERNAME_COLOR TRICKV_HOSTNAME

# Core shell workflow aliases
alias 'ls.'='ls -d .*'
alias l='ls'
alias ll='ls -l'
#alias h='history | tail'
alias h=trick_h
alias j=jobs
alias f=fg

# Application-specific aliases
alias lss='screen -ls'
alias pico='nano -w'
alias nano='nano -w'
alias strdate='date -u +%Y%m%d-%H%M%S'
alias bzip2='bzip2 --show-progress'

# Hilarity
alias y='echo Why, you ask? WHY NOT!'
alias ks="echo Learn to type.  You meant ls, right?"

# Conditional stuff
if [ -d $HOME/man ]; then export MANPATH=$MANPATH:$HOME/man; fi

UNAME=`uname`
if [ "${UNAME}" == "FreeBSD" ]; then
    # FreeBSD-specific stuff goes here!
    alias make=gmake
    export SHELL=/usr/local/bin/bash
    
    # I don't know what this does, but it's from a FreeBSD bash profile
    export CLICOLOR=1
fi

if [ "${UNAME}" == "Linux" ]; then
    # Linux-specific stuff goes here
    false
fi
unset $UNAME

# If we're in a screen session, alias over screen so that we don't end up with a Screen Within A Screen (think: Edgar Allen Poe)
if [ "${TERM}" == "screen" ]; then
    alias 'screen'='echo It appears that you are a masochist. Do not run screen within screen.  It causes cancer.'
fi

which colordiff &> /dev/null
if [ $? -eq 0 ]; then
#    alias 'svn diff'='svn diff $@ | colordiff'
    TRICK_SVN=`which svn`
    alias svn=my_svn
fi

my_svn () {
    # TODO: add handling for when piping to a file
    if [ "${1}" == "diff" ]; then
        $TRICK_SVN $* | colordiff
    else
        IFS=$'\n'
        $TRICK_SVN $*
    fi
}

trick_h () {
    if [ "$1" -gt 0 &> /dev/null ]; then
        !${1}
    else
        history
    fi
}
